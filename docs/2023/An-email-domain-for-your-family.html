<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> nicolabs | An email domain for your family </title> <meta name="description" content=" Work in progress... "> <meta name="keywords" content="android, development, java, javascript, python, web"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Facebook / Open Graph --> <meta property="og:type" content="article"> <meta property="article:author" content="nicobo"> <meta property="article:section" content=""> <meta property="article:tag" content=""> <meta property="article:published_time" content="2023-06-23 00:00:00 +0200"> <meta property="og:url" content="https://www.nicolabs.net/2023/An-email-domain-for-your-family"> <meta property="og:title" content=" nicolabs | An email domain for your family "> <meta property="og:image" content="https://www.nicolabs.net"> <meta property="og:description" content=" Work in progress... "> <meta property="og:site_name" content="nicobo"> <meta property="og:locale" content="en_US"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content="nic0b0"> <meta name="twitter:title" content=" nicolabs | An email domain for your family "> <meta name="twitter:description" content=" Work in progress... "> <meta name="twitter:image:src" content="https://www.nicolabs.net"> <!-- Social: Google+ / Schema.org --> <meta itemprop="name" content=" nicolabs | An email domain for your family "> <meta itemprop="description" content=" Work in progress... "> <meta itemprop="image" content="https://www.nicolabs.net"> <!-- rel prev and next --> <link rel="stylesheet" href="/assets/css/main.css"> <!-- Canonical link tag --> <link rel="canonical" href="https://www.nicolabs.net/2023/An-email-domain-for-your-family"> <link type="application/atom+xml" rel="alternate" href="https://www.nicolabs.net/feed.xml" title="nicolabs" /> <script type="text/javascript"> var disqus_shortname = 'nicolabs'; </script> <!-- Enable displaying pictures in full size using the Fullscreen API --> <!-- A polyfill that also simplifies the API. TODO maybe there are others closer to the norm and with more features. Still chances are this will not work on iPhone without using a full-fledged Js library. --> <script src="/assets/lib/screenfull.js/dist/screenfull.min.js"></script> <!-- This code selects which elements and how fullscreen is triggered --> <script> document.addEventListener("DOMContentLoaded", function(event) { var els = document.getElementsByClassName("plantuml"); for ( var e=0 ; e<els.length ; e++ ) { var el = els[e]; el.addEventListener('click', function() { if (screenfull.isEnabled) { screenfull.toggle(el); el.classList.toggle("fullscreen"); } else { console.log("Fullscreen not supported"); } }); } }); </script> <script> window.onscroll = function() { if (document.body.scrollTop > 0 || document.documentElement.scrollTop > 0) { document.querySelector('.site-header').classList.add('site-header-pinned'); } else { document.querySelector('.site-header').classList.remove('site-header-pinned'); } }; </script> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="/">nico<span>labs</span></a></h1> <ul class="navbar"> <li><a href="/about">about</a></li> <li><a href="/articles">articles</a></li> <li><a href="/feed.xml">feed</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <h1 class="post-title" itemprop="name headline">An email domain for your family</h1> <p class="post-meta"> <a href="https://github.com/nicolabs/nicolabs.github.io/commits/master/_posts/2023-06-23-An-email-domain-for-your-family.md" title="Read full history of this post"> <time class="datePublished" datetime="2023-06-23T00:00:00+02:00" itemprop="datePublished">Jun 23, 2023</time> </a> <span class="post-meta-separator">•</span> <span itemprop="read_time"> 7 minutes read </span> <span class="post-meta-separator">•</span> <span itemprop="maturity"><a href="/2016/Migrating-from-Drupal-to-Jekyll" title="Maturity of this article : draft < good < stable or deprecated&#xa;Click for the explanation.">Maturity : <span class="maturity-label maturity-good" title="Maturity of this article : draft < good < stable or deprecated">good</span> </span></a> </p> </header> <div class="post-content" itemprop="articleBody"> <p>Do you want your family members to share the same <strong>@&lt;put your family name here&gt;</strong> emails ?</p> <p>You have several choices :</p> <ol> <li>pay an email provider to host email accounts =&gt; this may become expensive if your pals send a lot of multimedia files through emails and require lots of GB</li> <li>self-host an email server =&gt; this implies a lot of administration if you want it to be highly available, including complex white-listing to bypass anti-spam filters</li> <li>let everyone choose their own email provider and use the common domain to redirect to/from them</li> </ol> <p><strong>This article is a very draft description on how to do it the 3rd way.</strong></p> <h2 id="the-pattern">The pattern</h2> <p>Let’s say you want everyone in your family (or friends) to share the same email domain : <strong>mom@myfunky.family</strong>, <strong>jul@myfunky.family</strong>, <strong>dog@myfunky.family</strong>, …</p> <p>For <em>Jul</em> which is using <code class="language-plaintext highlighter-rouge">jul@sadmail.org</code> that means :</p> <ol> <li>forward all incoming messages at <code class="language-plaintext highlighter-rouge">jul@myfunky.family</code> to <code class="language-plaintext highlighter-rouge">jul@sadmail.org</code></li> <li>allow sending out emails as <code class="language-plaintext highlighter-rouge">jul@myfunky.family</code> from <code class="language-plaintext highlighter-rouge">sadmail.org</code></li> </ol> <p>The basic steps for this are explained in the following paragraphs :</p> <ol> <li>Choose an email provider that will forward <code class="language-plaintext highlighter-rouge">@myfunky.family</code> messages to each member’s own address</li> <li>Register (rent) <code class="language-plaintext highlighter-rouge">myfunky.family</code> domain to a registrar and configure it</li> <li>Members must allow their account at their personal email provider to send e-mails with their family address</li> <li>Members may also need to add a new identify in their e-mail apps</li> </ol> <h2 id="choose-an-email-provider">Choose an email provider</h2> <p>You need an email server to forward emails received at <em>@myfunky.family</em> to each members’ personal mailbox.</p> <p>In this tutorial we don’t want to host the email server ourselves, so you may choose any email provider offering a <em>forwarding</em> service to external email addresses (I guess they all provide it). It may be the one of your personal mailbox or a totally different one. Often the domain registrar itself will offer it already so you probably don’t need to go further.</p> <p><strong>For each family member (after having configured the MX records) you will need to add a forward rule</strong> :</p> <table> <thead> <tr> <th>From</th> <th>To</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">jul@myfunky.family</code></td> <td><code class="language-plaintext highlighter-rouge">jul@sadmail.org</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">mom@myfunky.family</code></td> <td><code class="language-plaintext highlighter-rouge">mom455678@iamaboomer.com</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">dog@myfunky.family</code></td> <td><code class="language-plaintext highlighter-rouge">snoopy@snoopymail.waf</code></td> </tr> </tbody> </table> <p>See the mail provider for the exact procedure (if you’re using the domain registrar’s to do this, <a href="https://docs.gandi.net/en/gandimail/forwarding_and_aliases/index.html">you probably just have to change to the correct tab…</a>).</p> <p>Note that <strong>you will first need to configure the MX records</strong> on <code class="language-plaintext highlighter-rouge">myfunky.family</code> so you don’t loose emails - see below.</p> <h2 id="register-and-configure-the-family-domain">Register and configure the family domain</h2> <p>There are 2 things to configure on the domain :</p> <ul> <li>Set <a href="https://www.cloudflare.com/learning/dns/dns-records/dns-mx-record/">MX records</a> pointing at the <em>forwarding</em> email server you chose in 1.</li> <li>Set anti-spam records (<a href="https://www.cloudflare.com/learning/dns/dns-records/dns-spf-record/">a.k.a. “SPF”</a>) to allow other email providers to send upon the family addresses without being flagged as spammers</li> </ul> <h3 id="mx-records-">MX records :</h3> <p><strong>See the mail provider for the values tu put in the MX records</strong>. Basically, it consists of putting the email server address.</p> <p>If it is the domain registrar chances are it is already configured or there is a one-click procedure.</p> <p>Once MX records are configured, you can proceed to forwarding rules (see above).</p> <h3 id="spf-records-">SPF records :</h3> <p><em>Receiving</em> email on your <em>@myfunky.family</em> address is ultra-simple and most of the time instant (it’s just adding a forward rule at the email provider - see above).</p> <p>But <strong>to be able to send from this address you will have to set anti-spam records on the DNS</strong> to pass through spam filters : this is called <a href="https://www.cloudflare.com/learning/dns/dns-records/dns-spf-record/">SPF (Sender Policy Framework)</a>.</p> <p>The principle is simple : this is a <a href="https://www.cloudflare.com/learning/dns/dns-records/dns-txt-record/">TXT record</a> on the <code class="language-plaintext highlighter-rouge">myfunky.family</code> domain which contains the email providers allowed to send emails with this domain. For instance if some members use Gmail and others Yahoo Mail, you need to include both <code class="language-plaintext highlighter-rouge">_spf.google.com</code> and <code class="language-plaintext highlighter-rouge">_spf.mail.yahoo.com</code> to this list (exact values are provided by each mail provider).</p> <p>However, when including too many of them (this may come quickly since your family members probably use different email providers), you will reach the <strong>limit of 10 total DNS queries allowed</strong> by the SPF specification ! Important to know : <a href="https://toolbox.googleapps.com/apps/checkmx/">each initial domain may resolve to several ones</a> : for instance <code class="language-plaintext highlighter-rouge">_spf.google.com</code> currently resolves to 3 other domains (3 additional DNS queries).</p> <p>The only way to bypass this limitation is to directly include IP addresses instead of domain names, <strong>but then you must take care of updating them when they change</strong>. You <a href="https://dmarcly.com/blog/spf-permerror-too-many-dns-lookups-when-spf-record-exceeds-10-dns-lookup-limit">might find online tools</a> to do this - it’s called <a href="https://smalltechstack.com/blog/flattening-your-spf-record"><strong>SPF flattening</strong></a>, but I haven’t found a correct one. There are also tools to update by hand or automatically (<a href="https://github.com/nicolabs/gandi-spf-flatten/tree/main">here’s mine</a>).</p> <p>This was the touchy part, other steps are usually straightforward…</p> <h2 id="steps-for-each-family-member">Steps for each family member</h2> <h3 id="allow-their-account-to-send-e-mails-with-their-family-address">Allow their account to send e-mails with their family address</h3> <p>In ordert to <em>send</em> emails with their family address, members need to configure their own email provider : the procedure differs for each of them but it often imply sending a verification email to the new address <a href="https://support.google.com/mail/answer/22370">e.g. for Gmail</a>.</p> <h3 id="add-a-new-identity-in-their-e-mail-apps">Add a new identity in their e-mail apps</h3> <p>As a final step, each member will probably want to add their family address as a new identity so that they don’t need to manually change the <code class="language-plaintext highlighter-rouge">from:</code> field for each message to send.</p> <p>This is also a client-specific configuration (e.g. for <a href="https://docs.k9mail.app/en/6.400/settings/account/#manage-identities">K9-Mail</a> ; for <a href="https://support.mozilla.org/en-US/kb/using-identities">Thunderbird</a>).</p> <aside class="tags"> <ul class="tags"> <li class="tag"><a href="/tags#mail">#mail</a></li> <li class="tag"><a href="/tags#self-hosting">#self hosting</a></li> <li class="tag"><a href="/tags#domain">#domain</a></li> </ul> </aside> <aside class="share"> <strong>Share this :</strong> <a href="http://twitter.com/share?text=An email domain for your family&amp;url=https://www.nicolabs.net/2023/An-email-domain-for-your-family&amp;hashtags=web,dev,blog,soudev&amp;via=nic0b0" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">Twitter</a> <a href="https://www.facebook.com/sharer/sharer.php?u=https://www.nicolabs.net/2023/An-email-domain-for-your-family" onclick="window.open(this.href, 'facebook-share', 'width=550,height=235');return false;">Facebook</a> </aside> </div> </article> <footer class="site-footer"> <div class="container"> <small class="pull-left">&copy;2023 All rights reserved. Graphic banner from https://showyourstripes.info</small> <small class="pull-right">by <a rel="me" href="/about#contact">@nicobo</a></small> </div> </footer> </main> </body> </html>
